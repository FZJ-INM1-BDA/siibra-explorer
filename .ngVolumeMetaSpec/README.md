# Proposed spec for neuroglancer precomputed meta file

[Neuroglancer precomputed volume](https://github.com/google/neuroglancer/blob/master/src/neuroglancer/datasource/precomputed/README.md) is a versatile yet simple file format for the purpose of streaming multi/high resolution volume data. However, it is not without its faults. Amongst these are:

- Having to deal with millions, if not billions of files
- Lack of a "header" file, which describes some physical attributes of the volume

We are aware of the following initiatives, which to various degrees solves some of above:

- [ome-ngff](https://ngff.openmicroscopy.org/latest/)
- [zarr](https://github.com/zarr-developers/zarr-specs)

## Proposal

We propose the introduction of `meta` extensionless json file, at the same hierarchy as `info` file. So the file structure looks like:

```
- root
    - info
    - meta
    - 1mm
        - 0-64_0-64_0-64
        ...
    - 2mm
        - 0-64_0-64_0-64
        ...
```

Content below is autogenerated from schema
---


# Meta v1 Schema

type: `object`


| property | type | required |
| --- | --- | --- |
| version | `1` | true |
| data | [Generic Image](#definitions-data-image) \|\| [Single Channel Image](#definitions-data-image-1d) \|\| [Three Channel Image](#definitions-data-image-3d) |  |
| transform | [4x4 affine](#definitions-mat4) |  |
| preferredColormap | ([Shader Enum](#definitions-shader-enum))[] |  |
| https://schema.brainatlas.eu/github/humanbrainproject/neuroglancer | [neuroglancer specific configurations](#definitions-hbp-ng) |  |
| https://schema.brainatlas.eu/github/humanbrainproject/nehuba | [nehuba speicfic configurations](#definitions-hbp-nehuba) |  |
| bestViewPoints | ([Point Geometry](#definitions-geometry-point) \|\| [Plane Geometry](#definitions-geometry-plane) \|\| [Enclosed Geometry](#definitions-geometry-enclosed))[] |  |

<a name="definitions-data-image"></a>

# Generic Image

Generic image, with arbitary dimensions.

type: `object`


| property | type | required |
| --- | --- | --- |
| type | `"image"` | true |
| range | ([Value Range](#definitions-range))[] |  |

<a name="definitions-data-image-1d"></a>

# Single Channel Image

Describes an image with 1 dimension, e.g. used as greyscale image.

type: `object`


| property | type | required |
| --- | --- | --- |
| type | `"image/1d"` | true |
| range | ([Value Range](#definitions-range))[] |  |

<a name="definitions-data-image-3d"></a>

# Three Channel Image

Describes an image with 3 dimensions, mostly used as RGB image.

type: `object`


| property | type | required |
| --- | --- | --- |
| type | `"image/3d"` | true |
| range | ([Value Range](#definitions-range))[] |  |

<a name="definitions-range"></a>

# Value Range

Describes the range of values

type: `object`


| property | type | required |
| --- | --- | --- |
| min | number |  |
| max | number |  |

<a name="definitions-mat4"></a>

# 4x4 affine

type: `array`


<a name="definitions-vec3"></a>

# 3x1 Vector

type: `array`


<a name="definitions-vec4"></a>

# 4x1 Vector

type: `array`


<a name="definitions-geometry-point"></a>

# Point Geometry

type: `object`


| property | type | required |
| --- | --- | --- |
| type | `"point"` | true |
| value | [3x1 Vector](#definitions-vec3) |  |

<a name="definitions-geometry-plane"></a>

# Plane Geometry

type: `object`


| property | type | required |
| --- | --- | --- |
| type | `"plane"` | true |

<a name="definitions-geometry-enclosed"></a>

# Enclosed Geometry

type: `object`


| property | type | required |
| --- | --- | --- |
| type | `"enclosed"` |  |
| points | ([Point Geometry](#definitions-geometry-point))[] |  |

<a name="definitions-shader-enum"></a>

# Shader Enum

One of:

`greyscale` , `viridis` , `plasma` , `magma` , `inferno` , `jet`

<a name="definitions-hbp-ng"></a>

# neuroglancer specific configurations

configurations specific to hbp fork of neuroglancer

type: `object`


| property | type | required |
| --- | --- | --- |
| shader | string |  |

<a name="definitions-hbp-nehuba"></a>

# nehuba speicfic configurations

configuration specific to nehuba (layer on top of hbp fork of neuroglancer)

type: `object`


| property | type | required |
| --- | --- | --- |
| config | [configuration](#definitions-config) |  |

<a name="definitions-config"></a>

# configuration

configuration to be used by this volume

type: `object`


| property | type | required |
| --- | --- | --- |
| globals | [undefined](#definitions-globals) |  |
| zoomWithoutCtrl | boolean |  |
| rightClickWithCtrl | boolean |  |
| rotateAtViewCentre | boolean |  |
| zoomAtViewCentre | boolean |  |
| restrictUserNavigation | boolean |  |
| disableSegmentSelection | boolean |  |
| disableSegmentHighlighting | boolean |  |
| enableMeshLoadingControl | boolean |  |
| hideNeuroglancerUI | boolean |  |
| crossSectionBackground | [3x1 Vector](#definitions-vec3) |  |
| perspectiveViewBackground | [3x1 Vector](#definitions-vec3) |  |
| dataset | [undefined](#definitions-dataset) |  |
| layout | undefined |  |

<a name="definitions-globals"></a>

# untitled schema

type: `object`


| property | type | required |
| --- | --- | --- |
| useNehubaLayout | boolean |  |
| useNehubaMeshLayer | boolean |  |

<a name="definitions-dataset"></a>

# untitled schema

type: `object`


| property | type | required |
| --- | --- | --- |
| imageBackground | [3x1 Vector](#definitions-vec3) |  |
| initialNgState | [undefined](#definitions-initialNgState) |  |

<a name="definitions-initialNgState"></a>

# untitled schema

type: `object`
