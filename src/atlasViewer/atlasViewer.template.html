<div *ngIf = "meetsRequirement" class = "atlas-container">

  <layout-mainside
    [showSide] = "false"
    [overlay] = "false"
    (panelAnimationFlag) = "panelAnimationFlag($event)">
    <div maincontent>
      <ui-nehuba-container>
      </ui-nehuba-container>
      
      <atlas-banner>
      </atlas-banner>

    </div>
    <div [ngSwitch] = "sidePanelView$ | async" sidecontent>

      <!-- Data Browser -->
      <div *ngSwitchCase = "'dataBrowser'">
        <panel-component [bodyCollapsable] = "true">
          <div heading>
            Data Browser
          </div>
          <div body>
            <data-browser>
            </data-browser>
          </div>
        </panel-component>
      </div>

      <!-- Layer Browser -->
      <div *ngSwitchCase = "'ngLayer'">
        <panel-component [bodyCollapsable] = "true">
          <div heading>
            Layer Browser
          </div>
          <div body>
            <layer-browser >
            </layer-browser>
          </div>
        </panel-component>
      </div>

      <!-- Tools Browser-->
      <div *ngSwitchCase = "'toolsBrowser'">
        <panel-component [bodyCollapsable] = "true">
          <div heading>
            Tools Browser
          </div>
          <div body>          
            <plugin-banner>
            </plugin-banner>
          </div>
        </panel-component>
      </div>

      <!-- Default (shown at the beginning + sliver of time during closing of side bar)-->
      <div *ngSwitchDefault>
        
      </div>
      
      <!-- Docked Container-->
      <div dockedContainer>
        <ng-template #dockedContainer>
        </ng-template>
      </div>
    </div>

    <div resizeSliver>

      <span 
        container = "body"
        placement = "left"
        [tooltip] = "!(selectedPOI$ | async) ? '' : (((selectedPOI$ | async).length === 0 ? 'No' : (selectedPOI$ | async).length) + ' selected region' + ((selectedPOI$ | async).length > 1 ? 's' : '')) + ' of interest' "
        [ngClass] = "{'active-tab' : (sidePanelView$ | async) === 'dataBrowser'}" 
        (click) = "toggleSidePanel('dataBrowser')" 
        class = "tabContainer">
        <span  [@newEvent] = "selectedPOI$ | async" class = "highlightContainer">
        </span>
        <i class = "glyphicon glyphicon-search"></i>
        <span class = "badge" *ngIf = "(selectedPOI$ | async) && (selectedPOI$ | async).length > 0">
          {{ (selectedPOI$ | async).length }}
        </span>
      </span>

      <span 
        placement = "left"
        [tooltip] = "!ngLayers ? '' : ((ngLayers.length === 0 ? 'No' : ngLayers.length) + ' loaded layer' + (ngLayers.length > 1 ? 's' : ''))"
        [ngClass] = "{'active-tab' : (sidePanelView$ | async) === 'ngLayer'}" 
        (click) = "toggleSidePanel('ngLayer')" 
        class = "tabContainer">
        <span  [@newEvent] = "ngLayers" class = "highlightContainer">
        </span>
        <i class = "glyphicon glyphicon-list"></i>
        <span class = "badge" *ngIf = "ngLayers && ngLayers.length > 0">      
          {{ ngLayers.length }}
        </span>
      </span>

      <span 
        placement = "left"
        (mouseover) = "_toolIconsVisible = true" 
        (mouseout) = "_toolIconsVisible = false"
        [tooltip] = "_toolIconDockAll ? 'dock all widgets' : _toolIconFloatAll ? 'float all widgets' : 'Tools Browser'"
        [ngClass] = "{'active-tab' : (sidePanelView$ | async) === 'toolsBrowser'}" 
        (click) = "toggleSidePanel('toolsBrowser')" 
        class = "tabContainer">
        <i class="glyphicon glyphicon-wrench"></i>
        <span class ="badge">
          <span [class.hidden] = "_toolIconsVisible" >
            ...
          </span>
          <span [class.hidden] = "!_toolIconsVisible">
            <span class = "pointer-events" (click) = "$event.stopPropagation();this.widgetServices.dockAllWidgets()" (mouseover) = "_toolIconDockAll = true" (mouseout) = "_toolIconDockAll = false">
              <i class = "no-pointer-events glyphicon glyphicon-log-in"></i>
            </span>
            <span class = "mute-text">
              |
            </span>
            <span class = "pointer-events" (click) = "$event.stopPropagation();this.widgetServices.floatAllWidgets()" (mouseover) = "_toolIconFloatAll = true" (mouseout) = "_toolIconFloatAll = false">
              <i class = "no-pointer-events glyphicon glyphicon-new-window"></i>
            </span>
          </span>
        </span>
      </span>
    </div>
  </layout-mainside>

  <layout-floating-container
    zIndex = "9"
    #floatingOverlayContainer>
    <ng-template #floatingContainer>

    </ng-template>
    <div [style.transform] = "floatingMouseContextualContainerTransform" floatingMouseContextualContainer>
      <div *ngIf = "onhoverLandmark$ | async" contextualInnerContainer>
        <div contextualBlock>
          {{ onhoverLandmark$ | async }} <i><small class = "mute-text">dbl click to toggle select</small></i>
        </div>
      </div>
      <div *ngIf = "onhoverSegment$ | async as onhoverSegment" contextualInnerContainer>
        <div *ngIf = "onhoverSegment !== ''" contextualBlock>
          {{ onhoverSegment }} <i><small class = "mute-text">dbl click to toggle select</small></i>
        </div>
      </div>
    </div>
    <div toastContainer>
      <ng-template #toastContainer>
      </ng-template>
    </div>
  </layout-floating-container>

  <ng-template #temporaryContainer>
  </ng-template>

  <ng-template #pluginFactory>
  </ng-template>

</div>

<markdown-dom *ngIf = "!meetsRequirement" [markdown] = "constantsService.doesNotMeetRequirementMD" >
</markdown-dom>

<ng-template #dedicatedViewerToast>
  <!-- <div *ngIf = "dedicatedView$ | async">
    <span dedicatedviewertext>displaying : {{ dedicatedView$ | async | getFilenameFromPathname }}. </span>
    <span (click) = "clearDedicatedView()" class = "btn btn-link">clear</span>
  </div> -->
  <div *ngIf = "!(dedicatedView$ | async)">
    no special data is being displayed right now
  </div>
</ng-template>
