
<span hbpLogoContainer>
  <img src = "res/image/HBP_Primary_RGB_WhiteText.png" />
</span>
<div container>
  <dropdown-component
    (itemSelected) = "selectTemplate($event)"
    [activeDisplay] = "displayActiveTemplate"
    [selectedItem] = "selectedTemplate"
    [inputArray] = "loadedTemplates$ | async">
  
  </dropdown-component>
  
  <dropdown-component
    *ngIf = "selectedTemplate"
    (itemSelected) = "selectParcellation($event)"
    [activeDisplay] = "displayActiveParcellation"
    [selectedItem] = "selectedParcellation"
    [inputArray] = "selectedTemplate.parcellations">
  </dropdown-component>

  <div 
    *ngIf = "selectedTemplate"
    placement = "bottom"
    [outsideClick] = "true"
    [popover]="searchRegionTemplate"
    containerClass = "inputSearchContainer"
    triggers = ""
    #inputSearchRegionPopover = "bs-popover"
    searchRegionPopover>

    <input 
      (keydown.esc)="inputSearchRegionPopover.hide();$event.target.blur();searchTerm=''"
      [(ngModel)]="searchTerm"
      class = "form-control" 
      (click)="inputSearchRegionPopover.show()"
      type="text" 
      placeholder="Regions"/>
      
  </div>
</div>

<ng-template #searchRegionTemplate>
  <div [@showState] hideScrollbarContainer>
    <div treeContainer>
      <div treeHeader>
        <span>{{ selectedRegions.length }} {{ selectedRegions.length > 1 ? 'regions' : 'region' }} selected</span> 
        <span (click) = "clearRegions($event)" *ngIf = "selectedRegions.length > 0" class = "btn btn-link">clear all</span>
      </div>
      <flat-tree-component 
        *ngFor = "let child of selectedParcellation.regions "
        (treeNodeClick) = "handleClickRegion({inputItem:$event})"
        [inputItem] = "child"
        [renderNode] = "displayTreeNode.bind(this)"
        [searchFilter] = "filterTreeBySearch.bind(this)">
        
      </flat-tree-component>
    </div>
  </div>
</ng-template>