<logo-container *ngIf="!isMobile">
</logo-container>

<!-- hide icons when templates has yet been selected -->
<ng-template [ngIf]="selectedTemplate$ | async">
  <div
    [ngClass]="isMobile ? 'btnWrapper-lg' : ''"
    class="btnWrapper">
    <div
      tooltip="Layer"
      placement="right"
      (click)="clickLayer($event)"
      [ngClass]="layerbrowserIsShowing ? 'btn-primary' : 'btn-secondary'"
      class="shadow btn btn-sm rounded-circle">
      <i class="fas fa-layer-group">

      </i>
    </div>
  </div>
</ng-template>
<div
  *ngIf="false"
  [ngClass]="isMobile ? 'btnWrapper-lg' : ''"
  class="btnWrapper">
  <div
    tooltip="Plugins"
    (click)="clickPlugins($event)"
    placement="right"
    [ngClass]="pluginbrowserIsShowing ? 'btn-primary' : 'btn-secondary'"
    class="shadow btn btn-sm rounded-circle">
    <i class="fas fa-tools">

    </i>
  </div>
</div>

<div *ngIf="!isMobile
            && ((pluginServices.fetchedPluginManifests && pluginServices.fetchedPluginManifests.length)
            || pluginServices.orphanPlugins)">

  <button mat-mini-fab color="primary"
          #pluginButton
          class="search-fab"
          (click)="openPluginMenu()"
          [tooltip]="!pluginMenuTrigger? 'Tools' : null"
          placement="right">
    <i class="fas fa-wrench"></i>
  </button>

  <div [hidden]="!pluginMenuTrigger" #pluginMenu class="mat-menu-trigger-button-start-position icon-menu">
    <div class = "matMenuContainer"
         [ngClass]="constantService.darktheme? 'menuThemColorsDark': 'menuThemColorsLight'">
      <div class="container-fluid text-right">
        <span class="removeSelectedRegionIcon">
          Tools
        </span>
      </div>
      <div *ngIf="pluginServices.fetchedPluginManifests && pluginServices.fetchedPluginManifests.length">
        <div *ngFor="let manifest of pluginServices.fetchedPluginManifests"
             [ngClass]="constantService.darktheme? 'menuThemColorsDark': 'menuThemColorsLight'">
          <span class="mat-menu-item"
                [ngClass]="constantService.darktheme? 'menuThemColorsDark': 'menuThemColorsLight'"
                (click)="pluginServices.launchPlugin(manifest).catch(catchError)">
            {{ (manifest.displayName || manifest.name).slice(0, 1) }}
          </span>
        </div>
      </div>
      <div *ngIf="pluginServices.orphanPlugins">
        <div *ngFor="let manifest of pluginServices.orphanPlugins">
          <span class="mat-menu-item"
                [ngClass]="constantService.darktheme? 'menuThemColorsDark': 'menuThemColorsLight'"
                (click)="pluginServices.launchPlugin(manifest).catch(catchError)">
            {{ (manifest.displayName || manifest.name).slice(0, 1) }}
          </span>
        </div>
      </div>
    </div>
  </div>
</div>

<div *ngIf="!isMobile && dbService.instantiatedWidgetUnits && dbService.instantiatedWidgetUnits.length">
  <button *ngIf="dbService.instantiatedWidgetUnits.length === 1"
          mat-mini-fab color="primary"
          class="search-fab"
          [ngClass]="widgetServices.minimisedWindow.has(dbService.instantiatedWidgetUnits[0]) ? 'minimised-fab' : ''"
          (click)="widgetServices.minimisedWindow.delete(dbService.instantiatedWidgetUnits[0])"
          placement="right"
          [tooltip]="dbService.instantiatedWidgetUnits[0].title">
    <i class="fas fa-search"></i>
  </button>

  <button *ngIf="dbService.instantiatedWidgetUnits.length > 1"
          #selectedSearchButton
          mat-mini-fab color="primary"
          class="search-fab"
          (click)="openSearchMenu()"
          [matBadge] = "dbService.instantiatedWidgetUnits ? dbService.instantiatedWidgetUnits.length : null">
    <i class="fas fa-search"></i>
    <i class="fas fa-chevron-right search-opened-icon"></i>
  </button>

  <div [hidden]="!searchMenuTrigger" #selectedSearchMenu class="mat-menu-trigger-button-start-position icon-menu">
    <div [ngClass]="constantService.darktheme? 'menuThemColorsDark': 'menuThemColorsLight'" class="menu-padding">
      <div class="container-fluid text-center">
        <span class="removeSelectedRegionIcon">
          KG Search
        </span>
      </div>
      <div *ngFor="let wu of dbService.instantiatedWidgetUnits"
           [ngClass]="constantService.darktheme? 'menuThemColorsDark': 'menuThemColorsLight'">
              <span class="mat-menu-item"
                    (click)="widgetServices.minimisedWindow.delete(wu);!widgetServices.minimisedWindow.has(wu)? this.widgetServices.moveFloatingToFront(wu) : null"
                    [ngClass]="constantService.darktheme? 'menuThemColorsDark': 'menuThemColorsLight'">
                  <i class="opened-search-icon" [ngClass]="!widgetServices.minimisedWindow.has(wu)? 'fas fa-circle' : 'far fa-circle'"></i>
                {{wu.title}}
              </span>
      </div>
    </div>
  </div>
</div>

<div *ngIf="!isMobile && selectedRegions">
  <button *ngIf="selectedRegions.length > 0"
          #selectedRegionsButton
          mat-mini-fab color="primary"
          class="search-fab"
          (click)="openRegionMenu()"
          [tooltip]="!regionMenuTrigger? 'Selected regions' : null" placement="right"
          [matBadge] = "selectedRegions ? selectedRegions.length : null">
    <i class="fas fa-registered"></i>
  </button>

  <div [hidden]="!regionMenuTrigger" #selectedRegionsMenu class="mat-menu-trigger-button-start-position icon-menu">
    <div class = "matMenuContainer" [ngClass]="constantService.darktheme? 'menuThemColorsDark': 'menuThemColorsLight'">
      <div class="container-fluid text-right"><span (click)="clearSelectedRegions()" class="removeSelectedRegionIcon">Clear</span></div>
      <pill-component
              (click)="regionClicked(sr)"
              [containerStyle]="constantService.darktheme? {backgroundColor:'rgba(30,30,30,0)'} : {backgroundColor:'rgba(255,255,255,0.8)'}"
              [closeBtnStyle]="constantService.darktheme? {backgroundColor:'rgba(30,30,30,0)'} : {backgroundColor:'rgba(255,255,255,0.8)'}"
              [stopPropagationClose] = "selectedRegions.length > 1"
              (closeClicked)="removeRegionFromSelectedList(sr)"
              [title]="sr.name"
              *ngFor="let sr of selectedRegions">
      </pill-component>
    </div>
  </div>
</div>

<div *ngIf="isMobile">
  <div
          *ngFor="let wu of dbService.instantiatedWidgetUnits"
          [ngClass]="isMobile ? 'btnWrapper-lg' : ''"
          placement="right"
          [tooltip]="wu.title"
          class="btnWrapper">
    <div
            (click)="widgetServices.minimisedWindow.delete(wu)"
            [ngClass]="widgetServices.minimisedWindow.has(wu) ? 'btn-outline-info' : 'btn-info'"
            class="shadow btn btn-sm rounded-circle">
      <i class="fas fa-search"></i>
    </div>
  </div>

</div>