<logo-container *ngIf="!isMobile">
</logo-container>

<!-- hide icons when templates has yet been selected -->
<ng-template [ngIf]="selectedTemplate$ | async">
  <div
    *ngIf="false"
    [ngClass]="isMobile ? 'btnWrapper-lg' : ''"
    class="btnWrapper">
    <div
      [tooltip]="dataBrowserTitle"
      placement="right"
      (click)="clickSearch($event)"
      [ngClass]="databrowserIsShowing ? 'btn-primary' : 'btn-secondary'"
      class="shadow btn btn-sm rounded-circle">
      <i class="fas fa-search">

      </i>
    </div>
  </div>

  <div
    [ngClass]="isMobile ? 'btnWrapper-lg' : ''"
    class="btnWrapper">
    <div
      tooltip="Layer"
      placement="right"
      (click)="clickLayer($event)"
      [ngClass]="layerbrowserIsShowing ? 'btn-primary' : 'btn-secondary'"
      class="shadow btn btn-sm rounded-circle">
      <i class="fas fa-layer-group">

      </i>
    </div>
  </div>

<div
  *ngIf="false"
  [ngClass]="isMobile ? 'btnWrapper-lg' : ''"
  class="btnWrapper">
  <div
    tooltip="Plugins"
    (click)="clickPlugins($event)"
    placement="right"
    [ngClass]="pluginbrowserIsShowing ? 'btn-primary' : 'btn-secondary'"
    class="shadow btn btn-sm rounded-circle">
    <i class="fas fa-tools">

    </i>
  </div>
</div>

<div *ngIf="!isMobile
            && ((pluginServices.fetchedPluginManifests && pluginServices.fetchedPluginManifests.length)
            || pluginServices.orphanPlugins)">

  <button mat-button
          #pluginMenuOpener
          [matMenuTriggerFor]="pluginMenu"
          id="pluginMenuOpener"
          style="display:none;">
  </button>
  <button mat-mini-fab color="primary"
          class="search-fab"
          (click)="openPluginMenu()"
          [tooltip]="'Tools'"
          placement="right">
    <i class="fas fa-wrench"></i>
  </button>

  <mat-menu #pluginMenu="matMenu">
    <div class = "matMenuContainer"
         [ngClass]="constantService.darktheme? 'menuThemColorsDark': 'menuThemColorsLight'">
      <div class="container-fluid text-right">
        <span class="removeSelectedRegionIcon">
          Plugins
        </span>
      </div>
      <div *ngIf="pluginServices.fetchedPluginManifests && pluginServices.fetchedPluginManifests.length">
        <div *ngFor="let manifest of pluginServices.fetchedPluginManifests"
             [ngClass]="constantService.darktheme? 'menuThemColorsDark': 'menuThemColorsLight'">
          <span class="mat-menu-item"
                [ngClass]="constantService.darktheme? 'menuThemColorsDark': 'menuThemColorsLight'"
                (click)="pluginServices.launchPlugin(manifest).catch(catchError)">
            {{ (manifest.displayName || manifest.name).slice(0, 1) }}
          </span>
        </div>
      </div>
      <div *ngIf="pluginServices.orphanPlugins">
        <div *ngFor="let manifest of pluginServices.orphanPlugins">
          <span class="mat-menu-item"
                [ngClass]="constantService.darktheme? 'menuThemColorsDark': 'menuThemColorsLight'"
                (click)="pluginServices.launchPlugin(manifest).catch(catchError)">
            {{ (manifest.displayName || manifest.name).slice(0, 1) }}
          </span>
        </div>
      </div>
    </div>
  </mat-menu>
</div>

<div *ngIf="!isMobile && dbService.instantiatedWidgetUnits && dbService.instantiatedWidgetUnits.length">
  <button *ngIf="dbService.instantiatedWidgetUnits.length === 1"
          mat-mini-fab color="primary"
          class="search-fab"
          [ngClass]="widgetServices.minimisedWindow.has(dbService.instantiatedWidgetUnits[0]) ? 'minimised-fab' : ''"
          (click)="widgetServices.minimisedWindow.delete(dbService.instantiatedWidgetUnits[0])"
          placement="right"
          [tooltip]="dbService.instantiatedWidgetUnits[0].title">
    <i class="fas fa-search"></i>
  </button>

  <button mat-button [matMenuTriggerFor]="searchMenu"
          #selectedSearchMenuOpener
          id="selectedSearchMenuOpener"
          style="display:none;"></button>
  <button *ngIf="dbService.instantiatedWidgetUnits.length > 1"
          mat-mini-fab color="primary"
          class="search-fab"
          (click)="openSearchMenu()"
          [matBadge] = "dbService.instantiatedWidgetUnits ? dbService.instantiatedWidgetUnits.length : null">
    <i class="fas fa-search"></i>
    <i class="fas fa-chevron-right search-opened-icon"></i>
  </button>

  <mat-menu #searchMenu="matMenu" #searchMenuContent>
    <div class="container-fluid text-center"
         [ngClass]="constantService.darktheme? 'menuThemColorsDark': 'menuThemColorsLight'">
      <span class="removeSelectedRegionIcon">
        KG Search
      </span>
    </div>
    <div *ngFor="let wu of dbService.instantiatedWidgetUnits"
         [ngClass]="constantService.darktheme? 'menuThemColorsDark': 'menuThemColorsLight'">
            <span class="mat-menu-item"
                  (click)="widgetServices.minimisedWindow.delete(wu);!widgetServices.minimisedWindow.has(wu)? this.widgetServices.moveFloatingToFront(wu) : null"
                  [ngClass]="constantService.darktheme? 'menuThemColorsDark': 'menuThemColorsLight'">
                <i class="opened-search-icon" [ngClass]="!widgetServices.minimisedWindow.has(wu)? 'fas fa-circle' : 'far fa-circle'"></i>
              {{wu.title}}
            </span>
    </div>
  </mat-menu>
</div>

<div *ngIf="isMobile">
  <div
          *ngFor="let wu of dbService.instantiatedWidgetUnits"
          [ngClass]="isMobile ? 'btnWrapper-lg' : ''"
          placement="right"
          [tooltip]="wu.title"
          class="btnWrapper">
    <div
            (click)="widgetServices.minimisedWindow.delete(wu)"
            [ngClass]="widgetServices.minimisedWindow.has(wu) ? 'btn-outline-info' : 'btn-info'"
            class="shadow btn btn-sm rounded-circle">
      <i class="fas fa-search"></i>
    </div>
  </div>
</div>

<div *ngIf="!isMobile && selectedRegions">

  <button mat-button #selectedRegionsMenuOpener [matMenuTriggerFor]="regionMenu" id="selectedRegionsMenuOpener" style="display:none;"></button>
  <button *ngIf="selectedRegions.length > 0"
          #selectedRegionsButton
          mat-mini-fab color="primary"
          class="search-fab"
          (click)="openRegionMenu()"
          [tooltip]="'Selected regions'" placement="right"
          [matBadge] = "selectedRegions ? selectedRegions.length : null">
    <i class="fas fa-registered"></i>
  </button>

  <mat-menu #regionMenu="matMenu">
    <div class = "matMenuContainer" [ngClass]="constantService.darktheme? 'menuThemColorsDark': 'menuThemColorsLight'">
      <div class="container-fluid text-right"><span (click)="clearSelectedRegions()" class="removeSelectedRegionIcon">Clear</span></div>
      <pill-component
              (click)="regionClicked(sr)"
              [containerStyle]="constantService.darktheme? {backgroundColor:'rgba(30,30,30,0)'} : {backgroundColor:'rgba(255,255,255,0.8)'}"
              [closeBtnStyle]="constantService.darktheme? {backgroundColor:'rgba(30,30,30,0)'} : {backgroundColor:'rgba(255,255,255,0.8)'}"
              [stopPropagationClose] = "selectedRegions.length > 1"
              (closeClicked)="removeRegionFromSelectedList(sr)"
              [title]="sr.name"
              *ngFor="let sr of selectedRegions">
      </pill-component>
    </div>
  </mat-menu>

</div>

<div *ngIf="isMobile">
  <div
          *ngFor="let wu of dbService.instantiatedWidgetUnits"
          [ngClass]="isMobile ? 'btnWrapper-lg' : ''"
          placement="right"
          [tooltip]="wu.title"
          class="btnWrapper">
    <div
            (click)="widgetServices.minimisedWindow.delete(wu)"
            [ngClass]="widgetServices.minimisedWindow.has(wu) ? 'btn-outline-info' : 'btn-info'"
            class="shadow btn btn-sm rounded-circle">
      <i class="fas fa-search"></i>
    </div>
  </div>

</div>