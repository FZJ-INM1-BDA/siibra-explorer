<mat-card class="w-100 h-100 overflow-hidden d-block d-flex flex-column">

    <button mat-flat-button class="pl-0 d-flex flex-grow-0 align-items-center"><span class="align-self-start"><i
            class="fas fa-chevron-left"></i> Back to dataset list</span></button>

    <mat-divider class="position-relative mb-2"></mat-divider>

    <div class="flex-grow-5">
        Connectivity matrix for
        {{areaName}}

    </div>


    <div class="d-flex flex-column justify-content-start overflow-auto" *ngIf="connectedAreas.length">

        <!--            <div style="display: block; " [ngStyle]="{'height': connectedAreas.length * 20 + 'px'}">-->
        <!--                <canvas baseChart-->
        <!--                        chartType="horizontalBar"-->
        <!--                        [datasets]="barChartData"-->
        <!--                        [labels]="barChartLabels"-->
        <!--                        [colors]="barChartColors"-->
        <!--                        [options]="barChartOptions"-->
        <!--                        [legend]="false">-->
        <!--                </canvas>-->
        <!--            </div>-->


        <div *ngFor="let connection of connectedAreas; let i = index; let last = last"
             class="d-flex flex-column mr-1 position-relative"
             [ngClass]="(overConnectedAreaIndex === i || collapseMenu === i) && 'border'"
             (mouseover)="overConnectedAreaIndex = i" (mouseout)="overConnectedAreaIndex = -1"
             >

            <div class="d-flex align-items-center cursorPointer position-relative"
                 [matTooltip]="connection.name + ': ' + connection.numberOfConnections"
            (click)="collapseMenu === i? collapseMenu = -1 : collapseMenu = i">

                <small class="w-50 flex-1 no-wrap text-truncate"
                       style="line-height: 14px">{{connection.name.includes('Area ') ? connection.name.replace('Area ', '') : connection.name}}</small>
                <div class="w-100 flex-3 position-relative">


                    <div class="d-flex "
                         style="height: 10px; min-width: 3px; z-index: 2; text-align: right; "
                         [ngStyle]="{'width': +connection.numberOfConnections/connectedAreas[0].numberOfConnections*100 + '%'}"
                         [style.backgroundColor]="'rgb(' + connection.color.r + ',' + connection.color.g + ',' + connection.color.b + ')'">
                        <small class="mt-n1 ml-1 text-black">
                            {{overConnectedAreaIndex === i ? connection.numberOfConnections : ''}}
                        </small>
                    </div>

                    <div *ngIf="collapseMenu !== i">
                    <div class="vl border-left  border-dark position-absolute w-0"
                         style="height: calc(100% + 4px); left: 33.33%;">

                    </div>
                    <div class="vl border-left  border-dark position-absolute w-0"
                         style="height: calc(100% + 4px); left: 66.66%;">

                    </div>
                    <div class="vl border-left  border-dark position-absolute w-0"
                         style="height: calc(100% + 4px); left: 99.99%;">
                    </div>


                    <div *ngIf="last">
                        <div class="position-absolute"
                             [style.left]="'calc(33.33% - ' + getRoundNumber(connectedAreas[0].numberOfConnections * 1 / 3).toString().length*8 + 'px)'"
                        >
                            <small><i>{{getRoundNumber(connectedAreas[0].numberOfConnections * 1 / 3)}}</i></small>
                        </div>

                        <div class="position-absolute"
                             [style.left]="'calc(66.66% - ' + getRoundNumber(connectedAreas[0].numberOfConnections * 2 / 3).toString().length*8 + 'px)'">
                            <small><i>{{getRoundNumber(connectedAreas[0].numberOfConnections * 2 / 3)}}</i></small>
                        </div>

                        <div class="position-absolute"
                             [style.left]="'calc(99.99% - ' + getRoundNumber(connectedAreas[0].numberOfConnections).toString().length*8 + 'px)'">
                            <small><i>{{getRoundNumber(connectedAreas[0].numberOfConnections)}}</i></small>
                        </div>
                    </div>
                    </div>

                </div>
            </div>



            <div class="d-flex flex-column" *ngIf="collapseMenu === i">
                <mat-divider></mat-divider>
                <span class="mt-2 mr-2 ml-2">
                    <small>Region: {{connection.name}}</small>
                    <br>
                    <small>Number of Connection: {{connection.numberOfConnections}}</small>
                </span>
            <div class="d-flex align-items-center justify-content-between">
                <button mat-button
                        class="pt-0 pb-0 pr-1 pl-0"

                            >
<!--                        *ngIf="(selectedRegions$ | async) as selectedRegions"-->
<!--                        (click)="toggleRegionWithId(region.ngId, region.labelIndex, regionIsSelected(selectedRegions, region.ngId, region.labelIndex)); regionToolsMenuVisible = false; collapsedRegionDescription = false">-->
                  <span class="fa-stack fa-1x">
                    <i class="fas fa-hand-pointer fa-stack-1x"></i>
<!--                    <i class="fas fa-slash fa-stack-1x fa-inverse"-->
<!--                       *ngIf="regionIsSelected(selectedRegions, region.ngId, region.labelIndex)"></i>-->
                  </span>
<!--                    <span [innerText]="regionIsSelected(selectedRegions, region.ngId, region.labelIndex)? 'Deselect' : 'Select'"></span>-->
                    <small>Select</small>
                </button>
                <button mat-button
                        class="pt-0 pb-0 pr-1 pl-1"
                >
<!--                        (click)="navigateTo(region.position); regionToolsMenuVisible = false; collapsedRegionDescription = false">-->
                    <small><i class="fas fa-crosshairs"></i> Navigate</small>
                </button>

<!--                 ToDo Change other buttons font size to 10 if this button is available and remove w-100 classes-->
                                <button mat-button
                                        class="pt-0 pb-0 pr-1 pl-1 "
                                (click)="changeConnectivityRegion(connection.name)">
                                  <small><i class="fab fa-connectdevelop"></i> Connectivity</small>
                                </button>
            </div>
            </div>


        </div>


    </div>


</mat-card>