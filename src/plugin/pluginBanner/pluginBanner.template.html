<ng-template [ngIf]="view$ | async" let-view>

  <mat-list>
    <ng-template ngFor [ngForOf]="view.plugins" let-plugin>

      <ng-template [ngIf]="plugin | pluginDisabledReasons : view.atlas : view.template : view.parcellation" let-disableReasons>
        <ng-template [ngIf]="disableReasons.length > 0" [ngIfElse]="enabledTmpl">

          <mat-list-item [matTooltip]="'Plugin disabled: ' + disableReasons.join(', ')">
            <span class="sxplr-custom-cmp text warn">
              <i class="fas fa-exclamation-triangle"></i>
            </span>
            
            <span class="text-muted">
              {{ plugin.name }}
            </span>
          </mat-list-item>

        </ng-template>

        <ng-template #enabledTmpl>
          <button mat-menu-item (click)="launchPlugin(plugin)">
            {{ plugin.name }}
          </button>
        </ng-template>

      </ng-template>

    </ng-template>

    <ng-template sxplrExperimentalFlag [experimental]="true">
      <button mat-menu-item (click)="showTmpl(thirdPartyPluginTmpl)">
        <span>
          Add third party plugin
        </span>
      </button>
    </ng-template>
  </mat-list>

</ng-template>

<ng-template #thirdPartyPluginTmpl>
  <h2 mat-dialog-title>
    Add thirdparty plugin
  </h2>

  <mat-dialog-content>
    <form>
      <mat-form-field class="d-block">
        <mat-label>
          iframe index.html URL
        </mat-label>
        <input type="text" matInput placeholder="https://example.com/index.html" #urlInput>
      </mat-form-field>
    </form>
  </mat-dialog-content>

  <mat-dialog-actions align="end">
    <button (click)="addThirdPartyPlugin(urlInput.value)" mat-raised-button color="primary">
      Load
    </button>
    <button mat-dialog-close mat-button>
      cancel
    </button>
  </mat-dialog-actions>

</ng-template>