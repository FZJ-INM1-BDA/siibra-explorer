# Deployment

This document outline the standard operating procedure of how to rollout a new release on ebrains infrastructure.

## Requirement

node v20+

Go to https://docker-registry.ebrains.eu/harbor/projects/28/summary , and ensure sufficient disk space (> 1GB). If insufficient:

- `siibra/siibra-explorer` namespace: `2.*.*` that is not the latest can be deleted
- `siibra/siibra-api` namespace: `0.3.*[-worker|-worker-v4|server]` that is not the latest can be deleted
- above, any untagged image can be deleted
- if unsure, ask Xiao 

(optional) Ensure siibra-api `-rc` prerelease action completes without error. Ensure in `src/atlasComponents/sapi/sapi.service.ts`, `export const EXPECTED_SIIBRA_API_VERSION = ''` is set to the expected siibra-api version.

## Steps

0. Commit any changes. (Run `npm prepare-release` if necessary) push to staging/branch and PR and merge to staging.

1. Raise PR from staging to master, ensure all check passes

2. Go through the checklist generated by github-bot. This is a manual process, and is meant to take awhile. Ensure all passes.

3. (if siibra-api is also updated) release siibra-api first. When all actions passes, merge staging -> master. 